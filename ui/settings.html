<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <title>Configurações</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
    }

    textarea {
      width: 100%;
      height: 200px;
    }

    button {
      margin-top: 10px;
    }
  </style>
</head>

<body>
  <h2>Contatos Permitidos</h2>
  <p>Insira um nome por linha:</p>
  <textarea id="contacts"></textarea>
  <div style="margin-top: 1rem;">
    <label>
      <input type="checkbox" id="showMessages" />
      Exibir mensagens personalizadas
    </label>
  </div>
  <div style="margin-top: 1rem;">
    <h2>Cor do chat</h2>
    <label>
      <input type="color" id="chatColor" />
      Balões
    </label>
    <label>
      <input type="color" id="textChatColor" />
      Texto
    </label>
  </div>
  <br />
  <button onclick="save()">Salvar</button>
  <script>
    (function () {
      window.electronAPI.loadConfig().then(data => {
        document.getElementById('contacts').value = data.join('\n');
      });

      window.electronAPI.loadSettings().then(config => {
        document.getElementById('showMessages').checked = config.showMessages;

        const chatColor = config?.chatColor?.split('|');
        if (chatColor?.length) {
          document.getElementById('chatColor').value = chatColor[0];
          document.getElementById('textChatColor').value = chatColor[1];
        }
      });
    })()

    function save() {
      const raw = document.getElementById('contacts').value;
      const chatColor = document.getElementById('chatColor').value + '|' + document.getElementById('textChatColor').value;
      const lines = raw.split('\n').map(l => l.trim()).filter(l => l);
      const showMessages = document.getElementById('showMessages').checked;

      window.electronAPI.saveConfig(lines);
      window.electronAPI.saveSettings({ chatColor, showMessages });

      alert('Configurações salvas!\nPara as alterações entrar em vigor será necessário reinciar o aplicativo');
    }
  </script>
</body>

</html>